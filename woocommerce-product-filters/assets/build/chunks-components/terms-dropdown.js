"use strict";(self.webpackChunkwoocommerce_filters=self.webpackChunkwoocommerce_filters||[]).push([[771],{5959:function(e,t,n){n.r(t);var o=n(9307),s=n(9196),r=n.n(s),c=n(598),l=n(2819),a=n(5736),u=n(544),i=n(5236),f=n(7536),d=n(374),m=n(9950),p=n(389),g=n(4271),h=n(4184),E=n.n(h),v=n(4376);const b=WCF_Frontend;t.default=e=>{let{name:t,value:n,setValue:h,options:w,group:_,...y}=e;const{watch:k,resetField:C}=(0,f.Gc)(),S="yes"===b.filter_num_products,{layout:F}=y,{getGroup:L,getStoredValue:R,getInitialCounts:N,counts:B,prefilledValues:V,setPrefilling:A,submittedValues:I}=(0,p.CR)(),[O,z]=(0,s.useState)(!1),G=r().useRef(null),H=R(_,t),M=k(t,H),[T,U]=(0,s.useState)(H),[Y,Z]=(0,s.useState)([]),[j,x]=(0,s.useState)([]),D=(0,v.Lm)()<960,[P]=(0,u.I)((()=>{O&&z(!1)})),W=L(_),q=!!(0,l.has)(W,"data."+y.facet.slug)&&(0,s.useMemo)((()=>W.data[y.facet.slug]),[W.data[y.facet.slug]]);if(!q)return(0,o.createElement)(o.Fragment,null,(0,a.__)("No terms found for the specified taxonomy.","woocommerce-product-filters"));const J=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,l.forEach)(e,((e,n)=>{let o=e.label,s="";t&&(s=Array(2*t+1).join(" ")+"– "),o=s+o,j.push({label:o,id:e.id,slug:e.slug}),(0,l.has)(e,"children")&&Array.isArray(e.children)&&J(e.children,t+1,!1)}))};(0,i.H)((function(){J(q);const e=R(_,t);if(!(0,l.isEmpty)(e)){const t=(0,g.w8)(q,e);(0,l.isEmpty)(t)||U([t])}const n=N(t);(0,l.has)(B,t)?Z(B[t]):Z(n)})),(0,s.useEffect)((()=>{const e=M;if((0,l.isUndefined)(e)||!1===e)U([]);else if(!(0,l.isUndefined)(e)&&!1!==e){const t=(0,g.w8)(q,e);t?.id&&U([t])}}),[M]),(0,s.useEffect)((()=>{if((0,l.has)(V,t)){const e=(0,g.w8)(q,V[t].toString());(0,l.isEmpty)(e)||(A(!0),h(t,e.id.toString()),A(!1))}}),[V]),(0,s.useEffect)((()=>{(0,l.has)(I,t)||!0!==y.mobile||(A(!0),C(t),A(!1))}),[I]),(0,s.useEffect)((()=>((0,p.BB)(Z,t),g.YB.on("filterToggled-"+t,(e=>{h(t,[]),C(t),U("")})),()=>{g.YB.remove("filterToggled-"+t)})),[]),(0,d.Z)("wcf-reset-filters",(()=>{A(!0),h(t,!1),U(""),A(!1)}));const K=(e=>{const t=[];return(0,l.isEmpty)(Y)?[]:((0,l.forEach)(e,((e,n)=>{const o=Y.find((t=>t.facet_value===e?.slug));0!==(o?.counter||0)&&t.push(e)})),t)})(j),Q=E()("wcf-dropdown-wrapper",{"is-active":!(0,l.isEmpty)(T)}),X=b.searchable_mobile;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{ref:P,className:Q},(0,o.createElement)(c.Z,{options:K,value:T,placeholder:(0,l.isEmpty)(K)?(0,a.__)("No options available","woocommerce-product-filters"):y.label,onChange:e=>(e=>{const n=(0,l.map)(e,"id");U(e),h(t,n[0])})(e.value),searchable:D&&X,overrides:"horizontal"===F?m.Rd:m.Hz,noResultsMsg:(0,a.__)("No results"),getOptionLabel:e=>{let{option:t}=e,n=0;const s=Y.find((e=>e.facet_value===t?.slug));return n=s?.counter||0,(0,o.createElement)(o.Fragment,null,t.label,S&&(0,o.createElement)("span",{className:"wcf-choices-counter"},"(",n,")"))},clearable:!1,disabled:(0,l.isEmpty)(K),controlRef:G,onOpen:()=>{O?(G.current.setDropdownOpen(!1),z(!1)):z(!0)}})))}},544:function(e,t,n){n.d(t,{I:function(){return r}});var o=function(){},s=n(9196);function r(e,t){void 0===t&&(t=!0);var n=(0,s.useRef)(e),r=(0,s.useState)(null),c=r[0],l=r[1],a=(0,s.useCallback)((function(e){c&&!c.contains(e.target)&&n.current(e)}),[c]);(0,s.useEffect)((function(){n.current=e}));var u=(0,s.useCallback)((function(e){l(e)}),[]);return(0,s.useEffect)((function(){return t?(document.addEventListener("click",a,!0),document.addEventListener("ontouchstart",a,!0),function(){document.removeEventListener("click",a,!0),document.removeEventListener("ontouchstart",a,!0)}):o}),[t,a]),[u]}}}]);